比赛地址在 https://mp.weixin.qq.com/s/tZ9BmXfzGYpzrNm2Jl5Mrw

- `problem.py` 原题代码。为了不至于每次重复输入，我hook了 `input` 函数。另外一个作用是可以看到 `Decrypt`的结果
- `solution.py` 里面是前面1-6题和第8题的计算过程
- `brute_decrypt.py` 是去枚举所有的PIN码。为了并行搜索来加快速度，可以指定搜索起始值
- `guess_vmcode.py` 是第8题的代码，有几个分析步骤：
  - 要看真实运行情况下执行了哪些指令。这个二进制代码并不是紧凑的，如果偏移错了，那么反汇编代码就不正确。
  - 对这些真实运行的指令进行反汇编。反汇编的结果我贴在下面。
  - 然后就是开始看代码了。我大致看懂了是什么意思，但是对 `R2` 的循环次数不太确定。
  - 那么我们就可以对 `R2` 尝试修改小一些，看看到底循环多少次。事实证明是 2^`R2`-1次。
  - 这个推导公式应该是 f(n) = f(n-1) + ... + f(1) + n, f(1) = 1。
  - 然后假设f(n) = 2^n-1，正好可以匹配上这个推导公式。
  - 整个运算就是2x2矩阵相乘 (1 << 127) - 1 次，我们可以改进算法来加快求解。

下面是我反汇编出来的结果。因为我在每个指令开头加了PC的操作，所以看起来比较冗余。

```txt
000:	R15 += 2	R15 += 34
003:	R15 += 1	if not R2: R15 += 1
004:	R15 += 2	R15 += 2
006:	R15 += 1	pop R15
008:	R15 += 2	push R2; R2 += -1
010:	R15 += 2	R4 = R0 * R3
012:	R15 += 2	R5 = R1 * R9
014:	R15 += 2	R4 = R4 + R5
016:	R15 += 2	R4 = R4 % R6
018:	R15 += 1	push R4
019:	R15 += 2	R4 = R0 * R7
021:	R15 += 2	R5 = R1 * R8
023:	R15 += 2	R4 = R4 + R5
025:	R15 += 2	R1 = R4 % R6
027:	R15 += 1	pop R0
028:	R15 += 2	push R15; R15 += -27
030:	R15 += 2	push R15; R15 += -29
032:	R15 += 1	pop R2
033:	R15 += 1	if not R6: R15 += 1
034:	R15 += 1	pop R15
036:	R15 += 2	R0 = 5
038:	R15 += 2	R1 = 6
040:	R15 += 2	R3 = 3
042:	R15 += 2	R7 = 7
044:	R15 += 2	R8 = 8
046:	R15 += 2	R9 = 9
048:	R15 += 9	R6 = 99999999999999997
057:	R15 += 2	R2 = 127
059:	R15 += 2	push R15; R15 += -58
```

----------

通关之后的这段话，我觉得非常适合当代的父母。父母要学会放手，把孩子真正地当做人来看，而不只是自己的财产。

> 有一件事需要你明白。媽媽會永遠愛著你。但媽媽最愛的人是爸爸，你，日後會有最愛你的人，她會陪你渡過餘生，而不是我們。如果遇到了鍾意的人，請認真對待你的每一段感情。
